<% layout('layout/page') -%>

<form class="form-horizontal" method="POST" action="/login" name="login-form">
  <div class="form-group">
    <label for="inputName3" class="col-sm-2 control-label">Name</label>
    <div class="col-sm-10">
      <input type="text" class="form-control" id="inputName3" placeholder="Name" name="username" required >
    </div>
  </div>
  <div class="form-group">
    <label for="inputPassword3" class="col-sm-2 control-label">Password</label>
    <div class="col-sm-10">
      <input type="password" class="form-control" id="inputPassword3" placeholder="Password" name="password" required >
    </div>
  </div>
  <div class="form-group">
    <div class="col-sm-offset-2 col-sm-10">
      <button type="submit" class="btn btn-default">Sign in</button>
    </div>
  </div>
</form>

<script>
  $(document.forms['login-form']).on('submit', function() {
  	var form = $(this);

  	$.ajax({
  	  url: "/login",
  	  data: form.serialize(),
  	  method: "POST",
  	  complete: function() {
  	  
  	  },
  	  statusCode: {
  	    200: function() {
  	      window.location.href = "/tasks";
  	    },
  	    403: function(jqXHR) {
  	      $( document.forms['login-form'] ).append( '<div class="alert alert-danger col-sm-offset-2 col-sm-10" role="alert">' + jqXHR.responseText + '</div>' );
  	    }
  	  }
  	});
    return false;
  });
</script>